<app-navbar style="width: 100%" class="mat-elevation-z6"></app-navbar>


<app-phenonet-top-bar
  style="width: 100%; display: flex; justify-content: center; align-items: center; border-bottom: 1px solid rgba(0, 0, 0, 0.12);"
  [searchBarPhenotype]="mainDisease"
>
</app-phenonet-top-bar>

<main class="app-two-column-grid">
  <div style="gap: 35px;" class="v-flex">
    <app-graph-filter-bar
      [minGraphEdgeFreq]="minGraphEdgeFreq"
      [maxGraphEdgeFreq]="maxGraphEdgeFreq"
      [dropdownItems]="filterNodes"
      (sliderChange)="handleSliderInput($event)"
      (highlightDisease)="diseaseToBeHighlighted = $event"
    ></app-graph-filter-bar>

    <app-network-graph
      [disease]="mainDisease || 'phenonet'"
      [graphData]="mainDiseaseGraph"
      [sliderValue]="currSliderValue"
      [diseaseToBeHighlighted]="diseaseToBeHighlighted"
      (selectEdge)="onEdgeSelect($event)"
      (selectNode)="onNodeSelect($event)"
      (filterNodes)="filterNodes = $event"

    ></app-network-graph>


  </div>

  <div style="gap: 35px;" class="v-flex">
    <div *ngIf="!mainDisease" class="as-card with-padding">
      <p class="title-1">Phenonet</p>
      <div class="phenonet-all-hint">
        <p class="text">Select a</p>
        <div class="badge-node">NODE</div>
        <p class="text">or an</p>
        <div class="badge-edge">EDGE</div>
        <p class="text">from the network graph</p>
      </div>
    </div>


    <!--    <div style="display: flex;align-items: flex-start; flex-direction: column;gap:9px;padding-bottom: 35px"-->
    <!--         class="as-card with-padding">-->
    <!--      <div class="badge-node">NODE</div>-->
    <!--      <p class="title-1">GSE46184</p>-->
    <!--      <p class="subtitle-1 text-light-green">breast cancer</p>-->
    <!--    </div>-->

    <!--    <div style="display: flex;align-items: flex-start; flex-direction: column;gap:9px;padding-bottom: 35px"-->
    <!--         class="as-card with-padding">-->
    <!--      <div class="badge-edge">EDGE</div>-->

    <!--      <div style="display: flex;gap:6px;">-->

    <!--        <div class="v-flex" style="gap:9px;">-->
    <!--          <p class="title-1">GSE46184</p>-->
    <!--          <p class="subtitle-1 text-light-green" style="max-width: 150px">breast cancer</p>-->
    <!--        </div>-->


    <!--        <div><p class="title-1">-</p></div>-->

    <!--        <div class="v-flex" style="gap:9px;">-->
    <!--          <p class="title-1">GSE39088</p>-->
    <!--          <p class="subtitle-1 text-light-green" style="max-width: 150px">systemic lupus erythematosus </p>-->
    <!--        </div>-->

    <!--      </div>-->

    <div *ngIf="selectedEdge" style="padding-bottom: 29px" class="v-flex as-card">
      <div class="v-flex align-flex-start" style="gap:9px;padding: 17px 17px 0 17px">
        <div class="badge-edge">EDGE</div>
        <div class="flex" style="gap:6px;">
<!--          <div class="v-flex" style="flex: 0 0 auto;">-->
            <p class="title-1" style="flex: 0 0 auto; max-width: 220px">{{mainDisease}}</p>
<!--          </div>-->
          <div><p class="title-1">-</p></div>
<!--          <div class="v-flex" style="flex: 0 0 auto;">-->
            <p class="title-1" style="flex: 0 0 auto; max-width: 220px">{{selectedEdge.node}}</p>
<!--          </div>-->
        </div>
      </div>


      <app-study-pairs-list
        style="width: 100%; overflow: hidden"
        [parentComponentName]="'edge-info-panel'"
        [studyPairs]="selectedEdge.datasetPairs" [primaryDisease]="mainDisease"
        [secondaryDisease]="selectedEdge.node"></app-study-pairs-list>

    </div>


    <div *ngIf="mainDisease && !selectedEdge" class="info-panel">

      <div class="info-panel-top-part">
        <div class="v-flex align-flex-start" style="gap:9px;">
          <div class="badge-node">NODE</div>
          <p class="title-1" style="max-width: 270px">{{mainDisease}}</p>
        </div>


        <div class="h-flex" style="gap: 32px;margin-right: 10px;">

          <div class="statistic-info">
            <p class="stat-description">
              Neighbors
            </p>
            <p class="stat-value">
              {{mainDiseaseNeighborsCount}}
            </p>
          </div>

          <div class="statistic-info">
            <p class="stat-description">
              Studies
            </p>
            <p class="stat-value">
              {{mainDiseaseStudiesCount}}
            </p>
          </div>
        </div>


      </div>

      <mat-tab-group mat-align-tabs="start">
        <mat-tab label="Neighbors">
          <div style="height: 100%;width: 100%; overflow: hidden">
            <!-- This outer div is required, otherwise expanded rows on table are being auto expanded when changing between tabs -->
            <app-neighbors-table [connectedNodes]="connectedNodes" [mainDisease]="mainDisease"></app-neighbors-table>
          </div>
        </mat-tab>
        <mat-tab label="Studies">
          <div style="height: 100%;width: 100%; overflow: hidden">
            <!-- This outer div is required, otherwise expanded rows on table are being auto expanded when changing between tabs -->
            <app-studies-table [studies]="studies"></app-studies-table>
          </div>
        </mat-tab>
      </mat-tab-group>


    </div>
  </div>
</main>
